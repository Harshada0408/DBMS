sql 3




CREATE DATABASE IF NOT EXISTS office_db;
USE office_db;
CREATE TABLE IF NOT EXISTS dept (did INT AUTO_INCREMENT PRIMARY KEY, dname VARCHAR(30), city VARCHAR(20));
CREATE TABLE IF NOT EXISTS emp (eid INT AUTO_INCREMENT PRIMARY KEY, ename VARCHAR(30), salary INT, gender CHAR(1), did INT, FOREIGN KEY (did) REFERENCES dept(did));
INSERT INTO dept (dname, city) VALUES ('HR','Pune'),('IT','Mumbai'),('Admin','Delhi'),('Finance','Nashik');
INSERT INTO emp (ename, salary, gender, did) VALUES ('Harshada',55000,'F',2),('Sarvesh',48000,'M',2),('Riya',40000,'F',1),('Om',60000,'M',3),('Tanu',35000,'F',NULL);
SELECT * FROM dept;
SELECT * FROM emp;
SELECT e.ename, d.dname, d.city FROM emp e INNER JOIN dept d ON e.did=d.did;
SELECT e.ename, d.dname FROM emp e LEFT JOIN dept d ON e.did=d.did;
SELECT e.ename, d.dname FROM emp e RIGHT JOIN dept d ON e.did=d.did;
SELECT e.ename, d.dname FROM emp e CROSS JOIN dept d;
SELECT ename, salary FROM emp WHERE salary>(SELECT AVG(salary) FROM emp);
SELECT ename, salary FROM emp WHERE salary=(SELECT MAX(salary) FROM emp);
SELECT dname FROM dept WHERE did=(SELECT did FROM emp GROUP BY did ORDER BY COUNT(*) DESC LIMIT 1);
SELECT e.ename, e.salary FROM emp e WHERE e.salary>(SELECT AVG(salary) FROM emp WHERE did=e.did);
CREATE VIEW emp_view AS SELECT e.ename, e.salary, d.dname, d.city FROM emp e LEFT JOIN dept d ON e.did=d.did;
SELECT * FROM emp_view;
UPDATE emp SET salary=salary+5000 WHERE ename='Riya';
SELECT * FROM emp_view;
DROP VIEW emp_view;